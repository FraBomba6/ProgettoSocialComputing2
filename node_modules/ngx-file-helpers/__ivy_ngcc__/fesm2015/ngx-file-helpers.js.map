{"version":3,"file":"ngx-file-helpers.js","sources":["ngx-file-helpers/lib/read-file-impl.ts","ngx-file-helpers/lib/read-mode.enum.ts","ngx-file-helpers/lib/helpers.ts","ngx-file-helpers/lib/file-handler.ts","ngx-file-helpers/lib/file-dropzone.directive.ts","ngx-file-helpers/lib/file-picker.directive.ts","ngx-file-helpers/lib/ngx-file-helpers.module.ts","ngx-file-helpers/public-api.ts","ngx-file-helpers/ngx-file-helpers.ts"],"names":[],"mappings":"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","sourcesContent":["import { ReadFile } from './read-file';\r\nimport { ReadMode } from './read-mode.enum';\r\n\r\nexport class ReadFileImpl implements ReadFile {\r\n  get name(): string {\r\n    return this._underlyingFile.name;\r\n  }\r\n\r\n  get size(): number {\r\n    return this._underlyingFile.size;\r\n  }\r\n\r\n  get type(): string {\r\n    return this._underlyingFile.type;\r\n  }\r\n\r\n  get readMode(): ReadMode {\r\n    return this._readMode;\r\n  }\r\n\r\n  get content(): any {\r\n    return this._content;\r\n  }\r\n\r\n  get underlyingFile(): File {\r\n    return this._underlyingFile;\r\n  }\r\n\r\n  constructor(\r\n    private _underlyingFile: File,\r\n    private _readMode: ReadMode,\r\n    private _content: any\r\n  ) {}\r\n}\r\n","export enum ReadMode {\r\n  arrayBuffer,\r\n  binaryString,\r\n  dataURL,\r\n  text\r\n}\r\n","import { ReadFile } from './read-file';\r\nimport { ReadFileImpl } from './read-file-impl';\r\nimport { ReadMode } from './read-mode.enum';\r\n\r\nexport function coerceBooleanProperty(value: any): boolean {\r\n  return value != null && `${value}` !== 'false';\r\n}\r\n\r\nexport async function readFileAsync(\r\n  file: File,\r\n  readMode: ReadMode\r\n): Promise<ReadFile> {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n\r\n    reader.onload = (event: ProgressEvent) => {\r\n      const fileReader = event.target as FileReader;\r\n      const readFile = new ReadFileImpl(file, readMode, fileReader.result);\r\n\r\n      resolve(readFile);\r\n    };\r\n\r\n    reader.onerror = (event: ProgressEvent) => {\r\n      reject(event);\r\n    };\r\n\r\n    switch (readMode) {\r\n      case ReadMode.arrayBuffer:\r\n        reader.readAsArrayBuffer(file);\r\n        break;\r\n      case ReadMode.binaryString:\r\n        reader.readAsBinaryString(file);\r\n        break;\r\n      case ReadMode.text:\r\n        reader.readAsText(file);\r\n        break;\r\n      case ReadMode.dataURL:\r\n      default:\r\n        reader.readAsDataURL(file);\r\n        break;\r\n    }\r\n  });\r\n}\r\n","import { EventEmitter, Input, Output } from '@angular/core';\r\nimport { readFileAsync } from './helpers';\r\nimport { ReadFile } from './read-file';\r\nimport { ReadMode } from './read-mode.enum';\r\n\r\nexport abstract class FileHandler {\r\n  @Input()\r\n  public readMode: ReadMode;\r\n\r\n  @Input()\r\n  public filter: (\r\n    file: File,\r\n    index: number,\r\n    files: Array<File>\r\n  ) => boolean = () => true;\r\n\r\n  @Output()\r\n  public readStart = new EventEmitter<number>();\r\n\r\n  @Output()\r\n  public readEnd = new EventEmitter<number>();\r\n\r\n  protected async readFiles(\r\n    files: FileList,\r\n    onFileRead: (fileRead: ReadFile) => void\r\n  ): Promise<void> {\r\n    const filteredFiles = Array.from<File>(files).filter(this.filter);\r\n    const fileCount = filteredFiles.length;\r\n\r\n    this.readStart.emit(fileCount);\r\n\r\n    await Promise.all(\r\n      filteredFiles.map(async file => {\r\n        const readFile = await readFileAsync(file, this.readMode);\r\n        onFileRead(readFile);\r\n      })\r\n    );\r\n\r\n    this.readEnd.emit(fileCount);\r\n  }\r\n}\r\n","import { Directive, EventEmitter, HostListener, Output } from '@angular/core';\r\nimport { FileHandler } from './file-handler';\r\nimport { ReadFile } from './read-file';\r\n\r\n@Directive({\r\n  selector: '[ngxFileDropzone]',\r\n  exportAs: 'ngxFileDropzone'\r\n})\r\nexport class FileDropzoneDirective extends FileHandler {\r\n  @Output()\r\n  public fileDrop = new EventEmitter<ReadFile>();\r\n\r\n  @HostListener('dragenter', ['$event'])\r\n  public onDragEnter(event: DragEvent) {\r\n    event.stopPropagation();\r\n    event.preventDefault();\r\n  }\r\n\r\n  @HostListener('dragover', ['$event'])\r\n  public onDragOver(event: DragEvent) {\r\n    event.stopPropagation();\r\n    event.preventDefault();\r\n  }\r\n\r\n  @HostListener('drop', ['$event'])\r\n  public onDrop(event: DragEvent) {\r\n    event.stopPropagation();\r\n    event.preventDefault();\r\n\r\n    this.readFiles(event.dataTransfer.files, readFile =>\r\n      this.fileDrop.emit(readFile)\r\n    );\r\n  }\r\n}\r\n","import {\r\n  Directive,\r\n  ElementRef,\r\n  EventEmitter,\r\n  HostListener,\r\n  Input,\r\n  OnInit,\r\n  Output,\r\n  Renderer2\r\n} from '@angular/core';\r\nimport { FileHandler } from './file-handler';\r\nimport { coerceBooleanProperty } from './helpers';\r\nimport { ReadFile } from './read-file';\r\n\r\n@Directive({\r\n  selector: '[ngxFilePicker]',\r\n  exportAs: 'ngxFilePicker'\r\n})\r\nexport class FilePickerDirective extends FileHandler implements OnInit {\r\n  @Input()\r\n  public accept = '';\r\n\r\n  @Input()\r\n  public get multiple(): boolean {\r\n    return this._multiple;\r\n  }\r\n  public set multiple(value: boolean) {\r\n    this._multiple = coerceBooleanProperty(value);\r\n  }\r\n  private _multiple: boolean;\r\n\r\n  @Output()\r\n  public filePick = new EventEmitter<ReadFile>();\r\n\r\n  private _input: any;\r\n\r\n  constructor(private el: ElementRef, private renderer: Renderer2) {\r\n    super();\r\n  }\r\n\r\n  public ngOnInit() {\r\n    this._input = this.renderer.createElement('input');\r\n    this.renderer.appendChild(this.el.nativeElement, this._input);\r\n\r\n    this.renderer.setAttribute(this._input, 'type', 'file');\r\n    this.renderer.setAttribute(this._input, 'accept', this.accept);\r\n    this.renderer.setStyle(this._input, 'display', 'none');\r\n\r\n    if (this.multiple) {\r\n      this.renderer.setAttribute(this._input, 'multiple', 'multiple');\r\n    }\r\n\r\n    this.renderer.listen(this._input, 'change', (event: Event) =>\r\n      this._onListen(event)\r\n    );\r\n  }\r\n\r\n  public reset() {\r\n    if (!this._input) {\r\n      console.error(\r\n        'It seems that ngOnInit() has not been executed or that the hidden _input element is null. Did you mess with the DOM?'\r\n      );\r\n      return;\r\n    }\r\n\r\n    this._input.value = null;\r\n  }\r\n\r\n  @HostListener('click')\r\n  public browse() {\r\n    if (!this._input) {\r\n      console.error(\r\n        'It seems that ngOnInit() has not been executed or that the hidden _input element is null. Did you mess with the DOM?'\r\n      );\r\n      return;\r\n    }\r\n\r\n    this._input.click();\r\n  }\r\n\r\n  // The callback signature prevent the async/await usage\r\n  private _onListen(event: Event) {\r\n    const target = event.target as HTMLInputElement;\r\n\r\n    this.readFiles(target.files, readFile => this.filePick.emit(readFile))\r\n      // reset value to trick change event making it changeable every time\r\n      .finally(() => (target.value = ''));\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { FileDropzoneDirective } from './file-dropzone.directive';\r\nimport { FilePickerDirective } from './file-picker.directive';\r\n\r\n@NgModule({\r\n  declarations: [FileDropzoneDirective, FilePickerDirective],\r\n  imports: [],\r\n  exports: [FileDropzoneDirective, FilePickerDirective]\r\n})\r\nexport class NgxFileHelpersModule {}\r\n","/*\r\n * Public API Surface of ngx-file-helpers\r\n */\r\n\r\nexport * from './lib/file-dropzone.directive';\r\nexport * from './lib/file-picker.directive';\r\nexport * from './lib/ngx-file-helpers.module';\r\nexport * from './lib/read-file';\r\nexport * from './lib/read-mode.enum';\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n\nexport {FileHandler as ɵa} from './lib/file-handler';"]}